name: zzzzzzz

on:
  push:

defaults:
  run:
    shell: bash

env:
  LINK: https://mega.nz/file/lxMHwTxS#vTgkzV0RCMn8tBda1mqrZH8vZYywOtZh_iPHRPzKuxo
  LOGO: https://www.brandyports.com/attachments/cat33-jpg.14/
  GAME_NAME: ğ—Ÿğ—¶ğ—³ğ—² ğ—¶ğ—» ğ—¦ğ—®ğ—»ğ˜ğ—® ğ—–ğ—¼ğ˜‚ğ—»ğ˜ğ˜† [ğ˜ƒğŸ¬.ğŸ³.ğŸ®] [ğ—•ğ—¼ğ—¹ğ—± ğ—•ğ—®ğ˜€ğ—µ ğ—¦ğ˜ğ˜‚ğ—±ğ—¶ğ—¼ğ˜€]
  UPLOAD: asoy-gaming
  TZ: Asia/Jakarta
  LINK_MIRROR: https://sourceforge.net/projects/${UPLOAD}/files/$(cd $PWD && ls *apk)/download

jobs:
  deploy-android:
    name: Asoy-Gaming
    runs-on: ubuntu-latest
    container:
      image: anggit86/ubuntu:asoy

    steps:
      - uses: actions/checkout@v3
      
      - name: Setup SSH ğŸ’»
        run: |
          mkdir -p -m 0700 /root/.ssh
          cd /root/.ssh
          curl ${KNOWN_HOSTS} -o known_hosts
        env:
          SSH_KEY: ${{ secrets.SSH_KEY }}
          PUB_KEY: ${{ secrets.PUB_KEY }}
          KNOWN_HOSTS: ${{ secrets.KNOWN_HOSTS }}

      - name: Install MegaCmd â³
        run: |
          curl https://mega.nz/linux/MEGAsync/xUbuntu_20.04/amd64/megacmd_1.5.1-1.1_amd64.deb --output megacmd.deb
          echo path-include /usr/share/doc/megacmd/* > /etc/dpkg/dpkg.cfg.d/docker
          chmod +x megacmd.deb
          sudo apt install ./megacmd.deb -y

      - name: Download ğŸ“¥
        run: |
          mega-get ${LINK} $PWD

      - name: Upload ğŸ“¤
        run: |
          cd $PWD
          sshpass -p ${SF_PASSWORD} scp *.apk ${SF_USERNAME}@frs.sourceforge.net:/home/frs/project/${UPLOAD}
        env:
          SF_USERNAME: ${{ secrets.SF_USER }}
          SF_PASSWORD: ${{ secrets.SF_PASWORD }}

      - name: Release ğŸ“
        run: |
          telegram_message() {
               curl -v "https://api.telegram.org/bot""${TG_TOKEN}""/sendPhoto?chat_id=""${TG_ID}""${ARGS_EXTRA}" -H 'Content-Type: multipart/form-data' \
               --form photo="LOGO" \
               -F "parse_mode=html" \
               -F caption="$1"
          }
          TXT_CAPTION="${GAME_NAME}
          
          <b>â”â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</b>
          <b>â”ƒğŸ“¥ Download Link:</b> <a href=\"${LINK_MIRROR}\">Here</a>
          <b>â”ƒğŸ›¡ï¸ Ukuran: $(cd $PWD && ls -lh *apk | cut -d ' ' -f5)</b>
          <b>â”ƒğŸ“… Tanggal: $(date +%d\ %B\ %Y)</b>
          <b>â”ƒğŸ•” Waktu: $(date +%T)</b>
          <b>â”—â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</b>
          
          <b>â”â”â”€â”€Extras</b>
          <b>â”ƒâ¥ Gallery Unlocked Mod</b>
          <b>â”ƒâ¥ Inc. Patch</b>
          <b>â”ƒâ¥ Walkthrough Pdf</b>
          <b>â”—â”â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</b>"
          TG_TEXT="${TXT_CAPTION}"
          telegram_message "$TG_TEXT"
        env:
          TG_TOKEN: ${{ secrets.TG_TOKEN }}
          TG_ID: ${{ secrets.TG_ID }}
